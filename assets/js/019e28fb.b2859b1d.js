"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[3526],{93730:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>i,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>d,toc:()=>l});var t=n(85893),s=n(11151);const o={description:"How to extract the files you need from OTAs.",hide_table_of_contents:!0},r="Parse OTAs",d={id:"guides/ota",title:"Parse OTAs",description:"How to extract the files you need from OTAs.",source:"@site/docs/guides/ota.md",sourceDirName:"guides",slug:"/guides/ota",permalink:"/ipsw/docs/guides/ota",draft:!1,unlisted:!1,editUrl:"https://github.com/blacktop/ipsw/tree/master/www/docs/guides/ota.md",tags:[],version:"current",frontMatter:{description:"How to extract the files you need from OTAs.",hide_table_of_contents:!0},sidebar:"docs",previous:{title:"Parse dyld_shared_cache",permalink:"/ipsw/docs/guides/dyld"},next:{title:"Lookup DSC Symbols",permalink:"/ipsw/docs/guides/dump_dsc_syms"}},i={},l=[{value:"Download the <em>latest</em> beta OTA",id:"download-the-latest-beta-ota",level:4},{value:"Show OTA Info",id:"show-ota-info",level:4},{value:"List files in OTA",id:"list-files-in-ota",level:4},{value:"Extract file(s) from OTA zip <em>or</em> payloads that match a regex pattern",id:"extract-files-from-ota-zip-or-payloads-that-match-a-regex-pattern",level:4},{value:"Extract file(s) from OTA RIDIFF10 cryptex volumes",id:"extract-files-from-ota-ridiff10-cryptex-volumes",level:4},{value:"How to apply a RSR OTA patch",id:"how-to-apply-a-rsr-ota-patch",level:4}];function c(e){const a={admonition:"admonition",code:"code",em:"em",h1:"h1",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.h1,{id:"parse-otas",children:"Parse OTAs"}),"\n",(0,t.jsxs)(a.h4,{id:"download-the-latest-beta-ota",children:["Download the ",(0,t.jsx)(a.em,{children:"latest"})," beta OTA"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw download ota --platform ios --device iPhone15,2 --beta\n"})}),"\n",(0,t.jsxs)(a.p,{children:["To only download the OTA's ",(0,t.jsx)(a.code,{children:"dyld_shared_cache(s)"})," and ",(0,t.jsx)(a.code,{children:"kernelcache"})]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw download ota --platform ios --device iPhone15,2 --beta --dyld --kernel\n"})}),"\n",(0,t.jsx)(a.admonition,{title:"NOTE",type:"caution",children:(0,t.jsxs)(a.p,{children:["If you are downloading OTAs for iOS16.x or macOS13.x or newer this will only work when ran on a ",(0,t.jsx)(a.strong,{children:"macOS Ventura"})," host as it calls into a private API to apply the patch."]})}),"\n",(0,t.jsx)(a.p,{children:"To download the latest RSR (Rapid Security Release) OTA"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:'\u276f ipsw download ota --platform ios --device iPhone15,2 --build 20C5049e --beta --rsr \n   \u2022 Getting iOS 16.2 OTA      build=20C7750490e device=iPhone15,2 model=D73AP type="iOS162BetaRSR" \n        92.97 MiB / 92.97 MiB [==========================================================| \u2705  ] 58.85 MiB/s\n'})}),"\n",(0,t.jsx)(a.admonition,{type:"info",children:(0,t.jsxs)(a.p,{children:["The ",(0,t.jsx)(a.code,{children:"--build"})," flag is required for RSR OTAs"]})}),"\n",(0,t.jsx)(a.h4,{id:"show-ota-info",children:"Show OTA Info"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw ota info iOS16.2_OTAs/iPhone15,2_1418867a3b673659e7bcd30c3823ff997b4ba990.zip\n"})}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-markdown",children:"[OTA Info]\n==========\nVersion        = 16.2 \nBuildVersion   = 20C5058d\nOS Type        = Beta\nFileSystem     = 098-19014-027.dmg (Type: APFS)\n\nDevices\n-------\n\niPhone 14 Pro\n > iPhone15,2_D73AP_20C5058d\n   - TimeStamp: 14 Nov 2022 22:15:41 MST\n   - KernelCache: kernelcache.release.iphone15\n   - CPU: A16 Bionic (ARMv8.6-A), ID: t8120\n   - BootLoaders\n       * iBEC.d73.RELEASE.im4p\n       * iBoot.d73.RELEASE.im4p\n       * iBSS.d73.RELEASE.im4p\n       * LLB.d73.RELEASE.im4p\n       * sep-firmware.d73.RELEASE.im4p\n"})}),"\n",(0,t.jsx)(a.h4,{id:"list-files-in-ota",children:"List files in OTA"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw ota ls OTA.zip | head\n   \u2022 Listing files in OTA zip...\n[ OTA zip files ] --------------------------------------------------\n-rw-r--r-- 2022-11-28T05:58:49-07:00 3.9 kB Info.plist\n-rw-r--r-- 2022-11-28T05:41:25-07:00 29 MB  post.bom\n-rw-r--r-- 2022-11-28T05:41:25-07:00 35 kB  pre.bom\n-rw-r--r-- 2022-11-28T05:37:39-07:00 171 kB boot/BuildManifest.plist\n-r--r--r-- 2022-11-28T02:54:40-07:00 1.0 kB boot/Restore.plist\n-r--r--r-- 2022-11-28T00:43:23-07:00 386 B  boot/RestoreVersion.plist\n-r--r--r-- 2022-11-28T00:43:03-07:00 539 B  boot/SystemVersion.plist\n-rwxr--r-- 2022-11-18T01:59:39-07:00 20 MB  boot/kernelcache.release.iphone15\n-rw-r--r-- 2022-11-28T02:54:39-07:00 229 B  boot/Firmware/098-18456-028.dmg.root_hash\n"})}),"\n",(0,t.jsxs)(a.p,{children:["See if ",(0,t.jsx)(a.code,{children:"dyld"})," is in the OTA files"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw ota ls iPhone15,2_1418867a3b673659e7bcd30c3823ff997b4ba990.zip | grep dyld\n   \u2022 Listing files in OTA zip...\n   \u2022 Listing files in OTA payload...\n   \u2022 (OTA might not actually contain all these files if it is a partial update file)\n-rwxr-xr-x 2022-11-28T00:43:03-07:00 926 kB usr/lib/dyld\n"})}),"\n",(0,t.jsxs)(a.h4,{id:"extract-files-from-ota-zip-or-payloads-that-match-a-regex-pattern",children:["Extract file(s) from OTA zip ",(0,t.jsx)(a.em,{children:"or"})," payloads that match a regex pattern"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw ota extract OTA.zip '^System/Library/.*/dyld_shared_cache.*$'\n   \u2022 Extracting ^System/Library/.*/dyld_shared_cache.*$...\n      \u2022 Extracting -rwxr-xr-x   1.5 GB  /System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e to iPhone14,2_D63AP_19C5026i/dyld_shared_cache_arm64e\n      \u2022 Extracting -rwxr-xr-x   787 MB  /System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.1 to iPhone14,2_D63AP_19C5026i/dyld_shared_cache_arm64e.1\n      \u2022 Extracting -rwxr-xr-x   480 MB  /System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.symbols to iPhone14,2_D63AP_19C5026i/dyld_shared_cache_arm64e.symbols\n"})}),"\n",(0,t.jsx)(a.admonition,{type:"info",children:(0,t.jsxs)(a.p,{children:["\ud83c\udd95"," iOS 16.x/macOS 13.x OTAs now contain a RIDIFF10 cryptex volumes that contain the ",(0,t.jsx)(a.code,{children:"dyld_shared_cache"})," files"]})}),"\n",(0,t.jsx)(a.h4,{id:"extract-files-from-ota-ridiff10-cryptex-volumes",children:"Extract file(s) from OTA RIDIFF10 cryptex volumes"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw ota patch iPhone15,2_1418867a3b673659e7bcd30c3823ff997b4ba990.zip --output /tmp/PATCHES\n   \u2022 Patching cryptex-app to /tmp/PATCHES/20C5058d__iPhone15,2/AppOS/098-19380-032.dmg\n   \u2022 Patching cryptex-system-arm64e to /tmp/PATCHES/20C5058d__iPhone15,2/SystemOS/098-18456-028.dmg\n"})}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f tree /tmp/PATCHES/20C5058d__iPhone15,2/\n/tmp/PATCHES/20C5058d__iPhone15,2/\n\u251c\u2500\u2500 AppOS\n\u2502   \u2514\u2500\u2500 098-19380-032.dmg\n\u2514\u2500\u2500 SystemOS\n    \u2514\u2500\u2500 098-18456-028.dmg\n\n3 directories, 2 files\n"})}),"\n",(0,t.jsxs)(a.p,{children:["To extract the ",(0,t.jsx)(a.code,{children:"dyld_shared_cache"})," files from the cryptex volumes, you can now mount the volume and then copy the files out"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f open /tmp/PATCHES/20C5058d__iPhone15,2/SystemOS/098-18456-028.dmg # mount the volume\n"})}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:'\u276f find /Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex/ -name "dyld_shared_cache*" | head\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/DriverKit/System/Library/dyld/dyld_shared_cache_arm64e.symbols\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/DriverKit/System/Library/dyld/dyld_shared_cache_arm64e\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.33\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.34\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.02\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.05\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.04\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.03\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.35\n/Volumes/SydneyCSeed20C5058d.D73DeveloperSystemCryptex//System/Library/Caches/com.apple.dyld/dyld_shared_cache_arm64e.32\n'})}),"\n",(0,t.jsx)(a.h4,{id:"how-to-apply-a-rsr-ota-patch",children:"How to apply a RSR OTA patch"}),"\n",(0,t.jsx)(a.p,{children:'You must first download and "patch" the base OTA file'}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw download ota --platform ios --device iPhone15,2 --beta\n"})}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw ota patch iPhone15,2_17280b5c6122ee9c11e60081a2610e9766e8b892.zip --output /tmp/PATCHES\n   \u2022 Patching cryptex-app to /tmp/PATCHES/20C5049e__iPhone15,2/AppOS/098-19380-026.dmg\n   \u2022 Patching cryptex-system-arm64e to /tmp/PATCHES/20C5049e__iPhone15,2/SystemOS/098-18456-023.dmg\n"})}),"\n",(0,t.jsx)(a.p,{children:"Now download the corresponding RSR OTA patch that belongs to the base OTA file"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw download ota --platform ios --device iPhone15,2 --build 20D5024e --beta --rsr \n"})}),"\n",(0,t.jsxs)(a.admonition,{type:"info",children:[(0,t.jsxs)(a.p,{children:["To get the ",(0,t.jsx)(a.code,{children:"--build"})," value, you can use ",(0,t.jsx)(a.code,{children:"ipsw download ota --show-latest-build"})," like so"]}),(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:'\u276f ipsw download ota --platform ios --device iPhone15,2 --show-latest-build --beta\n"20D5024e"\n'})})]}),"\n",(0,t.jsx)(a.p,{children:"Now apply the patch to the base OTA file"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f ipsw ota patch --input /tmp/PATCHES/20C5049e__iPhone15,2 --output /tmp/PATCHES/ RSR_OTA.zip \n   \u2022 Patching cryptex-app to /tmp/PATCHES/20C7750490e__iPhone15,2/AppOS/098-50146-002.dmg\n   \u2022 Patching cryptex-system-arm64e to /tmp/PATCHES/20C7750490e__iPhone15,2/SystemOS/098-50080-002.dmg\n"})}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-bash",children:"\u276f tree /tmp/PATCHES/20C7750490e__iPhone15,2/ # Notice the new build number\n/tmp/PATCHES/20C7750490e__iPhone15,2/\n\u251c\u2500\u2500 AppOS\n\u2502   \u2514\u2500\u2500 098-50146-002.dmg\n\u2514\u2500\u2500 SystemOS\n    \u2514\u2500\u2500 098-50080-002.dmg\n\n3 directories, 2 files\n"})}),"\n",(0,t.jsxs)(a.p,{children:["Now you have the RSR patched files ready to start diffing ","\ud83d\ude0f"," ","\ud83c\udf89"]}),"\n",(0,t.jsx)(a.admonition,{title:"NOTE",type:"caution",children:(0,t.jsxs)(a.p,{children:["For now the ",(0,t.jsx)(a.code,{children:"ipsw ota patch"})," command will only work on ",(0,t.jsx)(a.strong,{children:"macOS Ventura"})," as it calls into a private API to apply the patch.  We plan on adding cross-platform support in the future."]})})]})}function h(e={}){const{wrapper:a}={...(0,s.a)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},11151:(e,a,n)=>{n.d(a,{Z:()=>d,a:()=>r});var t=n(67294);const s={},o=t.createContext(s);function r(e){const a=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function d(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:a},e.children)}}}]);