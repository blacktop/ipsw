"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[1065],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),d=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=d(e.components);return a.createElement(p.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=d(n),m=r,h=u["".concat(p,".").concat(m)]||u[m]||c[m]||o;return n?a.createElement(h,i(i({ref:t},s),{},{components:n})):a.createElement(h,i({ref:t},s))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:r,i[1]=l;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},778:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var a=n(7462),r=(n(7294),n(3905));const o={description:"Analyze Dylibs in DSC with IDA Pro."},i="Analyze Dylibs in DSC with IDA Pro",l={unversionedId:"guides/ida_pro",id:"guides/ida_pro",title:"Analyze Dylibs in DSC with IDA Pro",description:"Analyze Dylibs in DSC with IDA Pro.",source:"@site/docs/guides/ida_pro.md",sourceDirName:"guides",slug:"/guides/ida_pro",permalink:"/ipsw/docs/guides/ida_pro",draft:!1,editUrl:"https://github.com/blacktop/ipsw/tree/master/www/docs/guides/ida_pro.md",tags:[],version:"current",frontMatter:{description:"Analyze Dylibs in DSC with IDA Pro."},sidebar:"docs",previous:{title:"PongoOS",permalink:"/ipsw/docs/guides/pongo"},next:{title:"Roadmap",permalink:"/ipsw/docs/roadmap"}},p={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Running with host IDA Pro",id:"running-with-host-ida-pro",level:2},{value:"Trouble Shooting \ud83e\udd14",id:"trouble-shooting-",level:3},{value:"Add the <code>-V</code> verbose flag to see stdout/stderr from IDA Pro.",id:"add-the--v-verbose-flag-to-see-stdoutstderr-from-ida-pro",level:4},{value:"Running with Docker",id:"running-with-docker",level:2},{value:"Prep host for <strong>docker</strong> GUI application support <em>(on macOS)</em>",id:"prep-host-for-docker-gui-application-support-on-macos",level:4},{value:"Building IDA Pro for Docker",id:"building-ida-pro-for-docker",level:3},{value:"Running <em>headless</em> in Docker",id:"running-headless-in-docker",level:3}],s={toc:d},u="wrapper";function c(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"analyze-dylibs-in-dsc-with-ida-pro"},"Analyze Dylibs in DSC with IDA Pro"),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"This command is intended to automate generating .idb(s) for dylibs in the DSC with IDA Pro.")),(0,r.kt)("p",null,"In addition to loading a selected dylib ",(0,r.kt)("em",{parentName:"p"},"(and any addition dylibs supplied as arguments)")," into IDA Pro ",(0,r.kt)("em",{parentName:"p"},"(in single module mode)"),", it will also:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Generates an IDAPython script to load sane default support dylibs and analyze ObjC info"),(0,r.kt)("li",{parentName:"ul"},"Generates a descriptive name for the compressed IDB file output"),(0,r.kt)("li",{parentName:"ul"},"Allows you to slide the dylib in memory to a specific address with the ",(0,r.kt)("inlineCode",{parentName:"li"},"--slide")," flag to match an ",(0,r.kt)("inlineCode",{parentName:"li"},"lldb")," session or ",(0,r.kt)("inlineCode",{parentName:"li"},"crashlog")),(0,r.kt)("li",{parentName:"ul"},"Load all the of dependancies of a given dylib with the ",(0,r.kt)("inlineCode",{parentName:"li"},"-d")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"--dependancies")," flag"),(0,r.kt)("li",{parentName:"ul"},"If you just want to peek at a dylib you can use the ",(0,r.kt)("inlineCode",{parentName:"li"},"--enable-gui")," flag to open the IDB in IDA Pro GUI with the ",(0,r.kt)("inlineCode",{parentName:"li"},"--temp-db")," flag to prevent IDA Pro from creating a new IDB file"),(0,r.kt)("li",{parentName:"ul"},"Create a log file of the IDA Pro output with the ",(0,r.kt)("inlineCode",{parentName:"li"},"-l")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"--log-file")," flag"),(0,r.kt)("li",{parentName:"ul"},"Want you run your own IDA Pro script?  Use the ",(0,r.kt)("inlineCode",{parentName:"li"},"--script")," flag and the ",(0,r.kt)("inlineCode",{parentName:"li"},"--script-args")," flag to pass arguments to your script"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"COMING SOON")," - Load all the GOTs and stubs for a given dylib and the sane defaults")),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"/docs/cli/ipsw/dyld/ida"},"CLI Reference")," for more info."),(0,r.kt)("h2",{id:"running-with-host-ida-pro"},"Running with host IDA Pro"),(0,r.kt)("p",null,"To prep an IDA Pro session to analyze the ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," dylib in the DSC"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\u276f ipsw dyld ida dyld_shared_cache_arm64e Email --enable-gui --delete-db\n")),(0,r.kt)("p",null,"This will open the ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," dylib in the IDA Pro GUI and load the sane default support dylibs and analyze ObjC info in a few minutes."),(0,r.kt)("h3",{id:"trouble-shooting-"},"Trouble Shooting \ud83e\udd14"),(0,r.kt)("h4",{id:"add-the--v-verbose-flag-to-see-stdoutstderr-from-ida-pro"},"Add the ",(0,r.kt)("inlineCode",{parentName:"h4"},"-V")," verbose flag to see stdout/stderr from IDA Pro."),(0,r.kt)("p",null,"A possible error could be that you are trying to analyze your systems DSC in a read-only folder and IDA Pro can't create it's IDB there so you'll need to supply the ",(0,r.kt)("inlineCode",{parentName:"p"},"--output")," flag to specify a writable folder for IDBs and logs."),(0,r.kt)("p",null,"Another possible error I've seen is if you are using an older version of IDA Pro that doesn't support the newer DSC format it will fail.  For example if you are using IDA Pro 7.x and try to analyze a DSC from iOS 16.x it will fail etc."),(0,r.kt)("h2",{id:"running-with-docker"},"Running with Docker"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"This requires that you have built a ",(0,r.kt)("strong",{parentName:"p"},"licensed")," version of IDA Pro for Docker.")),(0,r.kt)("h4",{id:"prep-host-for-docker-gui-application-support-on-macos"},"Prep host for ",(0,r.kt)("strong",{parentName:"h4"},"docker")," GUI application support ",(0,r.kt)("em",{parentName:"h4"},"(on macOS)")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Install XQuartz ",(0,r.kt)("inlineCode",{parentName:"li"},"brew install --cask xquartz")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"open -a XQuartz")," and make sure you ",(0,r.kt)("strong",{parentName:"li"},'"Allow connections from network clients"')," in the Security tab"),(0,r.kt)("li",{parentName:"ol"},"Now add the IP using Xhost with: ",(0,r.kt)("inlineCode",{parentName:"li"},"xhost + 127.0.0.1")," or ",(0,r.kt)("inlineCode",{parentName:"li"},"xhost + $(ipconfig getifaddr en0)"))),(0,r.kt)("h3",{id:"building-ida-pro-for-docker"},"Building IDA Pro for Docker"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\u276f git clone https://github.com/blacktop/docker-idapro.git\n\u276f cd docker-idapro\n")),(0,r.kt)("p",null,"1) Put a copy of the ",(0,r.kt)("strong",{parentName:"p"},"linux")," installer in the ",(0,r.kt)("inlineCode",{parentName:"p"},"pro")," folder and name it ",(0,r.kt)("inlineCode",{parentName:"p"},"idapro.run")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'IDAPW="put-your-install-pw-here" make build-pro\n')),(0,r.kt)("p",null,"2) Enter image container:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"make ssh-pro\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"root@add3b0fd6966:/ida# ./ida64\n")),(0,r.kt)("p",null,"3) This will open the GUI; now accept the license agreement and set any settings you want to persist and close the window."),(0,r.kt)("p",null,"4) Rebuild the IDA Pro image with the new ",(0,r.kt)("inlineCode",{parentName:"p"},"ida.reg")," file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"make build-reg\n")),(0,r.kt)("p",null,"This will create a new image called ",(0,r.kt)("inlineCode",{parentName:"p"},"blacktop/ida:8.2-pro"),"  "),(0,r.kt)("p",null,"You can change that name with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\u276f docker tag blacktop/ida:8.2-pro YOUR_ORG/ida:8.2-pro-licensed\n")),(0,r.kt)("p",null,"and then push that to your private registry."),(0,r.kt)("p",null,"Congratulations!  You now have a registered IDA Pro image that you can perform headless analysis with \ud83c\udf89"),(0,r.kt)("h3",{id:"running-headless-in-docker"},"Running ",(0,r.kt)("em",{parentName:"h3"},"headless")," in Docker"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"\u276f ipsw dyld ida dyld_shared_cache_arm64e Email --delete-db --output . \\\n                     --docker --docker-image blacktop/idapro:8.2-pro\n   \u2022 Starting IDA Pro...\n   \u2022 \ud83c\udf89 Done!                   db=DSC_Email_iOS_15.7.i64\n")),(0,r.kt)("p",null,"About ",(0,r.kt)("inlineCode",{parentName:"p"},"4m 37s")," later..."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'\u276f ll DSC_Email_iOS_15.7.i64\n-rw-r--r--  1 blacktop  staff   "183M" Mar 13 12:23 DSC_Email_iOS_15.7.i64\n')),(0,r.kt)("p",null,"Now an analyst can open the ready to go ",(0,r.kt)("inlineCode",{parentName:"p"},"DSC_Email_iOS_15.7.i64")," file in IDA Pro and start analyzing the dylib."))}c.isMDXComponent=!0}}]);