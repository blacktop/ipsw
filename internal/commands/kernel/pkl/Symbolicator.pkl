@go.Package { name = "github.com/blacktop/ipsw/pkg/signature" }
module io.blacktop.Symbolicator

import "package://pkg.pkl-lang.org/pkl-go/pkl.golang@0.8.0#/go.pkl" 

// TODO: add darwin version range
// TODO: add MH_FILESET entry
// TODO: byte pattern matching

/// The target for the signatures.
target: String

class Signature {
    /// The number of args.
    args: UInt16

    /// The unique strings in function.
    anchors: Listing<String>

    /// The name of the function this signature matches.
    symbol: String

    /// The name of the function that calls this function.
    caller: String
}

signatures: Listing<Signature>(isDistinct)